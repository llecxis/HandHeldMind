(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67616,       1772]
NotebookOptionsPosition[     63539,       1698]
NotebookOutlinePosition[     63880,       1713]
CellTagsIndexPosition[     63837,       1710]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "Quaternions`"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"1a423ba5-509c-4106-8a0e-d1be1ea25de7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wa", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X0", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NRefImu", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X1", "=", 
    RowBox[{"Quaternion", "[", 
     RowBox[{"x11", ",", "x12", ",", "x13", ",", "x14"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wc", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"t1", ",", "t2", ",", "t3", ",", "t4"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NArmImu", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"b1", ",", "b2", ",", "b3", ",", "b4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7893230829962254`*^9, 3.78932311026122*^9}, {
  3.789323141585171*^9, 3.789323146947815*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7a0613a9-044a-4a9d-ac34-ff9801eaa194"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{"0.618", ",", "0.315", ",", "0.303", ",", "0.654"}], "}"}]}], ";",
   " ", 
  SubscriptBox["W", "A"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "}"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6"}], ",", 
     RowBox[{"-", "0.04"}], ",", 
     RowBox[{"-", "0.026"}], ",", "0.745"}], "}"}]}], ";", " ", 
  SuperscriptBox["A", "n"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"x11", ",", "x12", ",", "x13", ",", "x14"}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{"0.95", ",", "0.", ",", "0.25", ",", "0."}], "}"}]}], ";", 
  SubscriptBox["W", "c"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{"0.004", ",", "0.01", ",", "0.974", ",", "0.228"}], "}"}]}], ";", 
  "n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7"}], ",", 
     RowBox[{"-", "0.69"}], ",", "0.138", ",", "0.032"}], "}"}]}], ";", 
  "T"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.02"}], ",", "0.028", ",", "0.45", ",", "0.892"}], 
    "}"}]}], ";", " ", 
  SuperscriptBox["T", "n"], ";"}]}], "Input",
 CellChangeTimes->{{3.7893189692540655`*^9, 3.789318978786792*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"a49f5a99-b1d8-4e04-8b1e-edb2ffdcb692"],

Cell[BoxData[
 SubscriptBox["W", "c"]], "Output",
 CellChangeTimes->{{3.7893189644787035`*^9, 3.789318980425785*^9}, 
   3.789319227759914*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"15c77e51-74a3-47b7-9df9-0c32269419d5"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4"}], "]"}]], "Output",
 CellChangeTimes->{{3.7893189644787035`*^9, 3.789318980425785*^9}, 
   3.789319227783913*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"423be174-a67e-4afb-b9fb-e77d1f2cf03d"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{"t1", ",", "t2", ",", "t3", ",", "t4"}], "]"}]], "Output",
 CellChangeTimes->{{3.7893189644787035`*^9, 3.789318980425785*^9}, 
   3.7893192278119135`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"10566cd7-96e4-4ee6-87ce-58144a42a20e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Quaternion", "[", 
    RowBox[{"0.618", ",", "0.315", ",", "0.303", ",", "0.654"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{"0.95", ",", "0.", ",", "0.25", ",", "0."}], "}"}]}], ";", " ", 
  "n", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6"}], ",", 
     RowBox[{"-", "0.04"}], ",", 
     RowBox[{"-", "0.026"}], ",", "0.745"}], "}"}]}], ";", " ", "Z", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.02"}], ",", "0.028", ",", "0.45", ",", "0.892"}], 
    "}"}]}], ";", " ", 
  SuperscriptBox["T", "n"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " ", "=", 
    RowBox[{"{", 
     RowBox[{"0.004", ",", "0.01", ",", "0.974", ",", "0.228"}], "}"}]}], ";", 
   SuperscriptBox["Z", "n"], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3", ",", "c4"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7"}], ",", 
     RowBox[{"-", "0.69"}], ",", "0.138", ",", "0.032"}], "}"}]}], ";", "T", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789319067694374*^9, 3.7893190823969316`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"0df3f08d-f360-4e1f-ab99-ed717673b09e"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7893192068953524`*^9, 3.7893192126897645`*^9}, {
   3.789319440596304*^9, 3.7893194680273046`*^9}, {3.789319528178184*^9, 
   3.7893195316151705`*^9}, 
   3.7893214629549866`*^9},ExpressionUUID->"cc426fe5-14f3-494c-9932-\
c74cf05f518d"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{"0.618`", ",", "0.315`", ",", "0.303`", ",", "0.654`"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7893194418240557`*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"a70f83fd-aa60-41ad-9c71-887949104d29"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"0.95", ",", "0.", ",", "0.25", ",", "0."}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"NRefImu", "**", 
  RowBox[{"(", 
   RowBox[{"NArmImu", "**", "Wc"}], ")"}], " "}]}], "Input",
 CellChangeTimes->{{3.789322881720314*^9, 3.7893228995459414`*^9}, {
   3.7893229330848637`*^9, 3.789322996897379*^9}, {3.789323120137915*^9, 
   3.789323152683297*^9}, 3.7893232407013254`*^9, {3.789330414289649*^9, 
   3.789330442728383*^9}, {3.7893352006694317`*^9, 3.78933523765055*^9}, {
   3.7893388811048446`*^9, 3.7893389218142586`*^9}, {3.789338964869444*^9, 
   3.78933898497219*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"19c130cc-1387-4d42-b7ea-e320baa10302"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.95`", ",", "0.`", ",", "0.25`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7893231613557005`*^9, 3.7893234397511044`*^9, 3.7893304169021177`*^9, 
   3.7893304533149104`*^9, 3.7893352066623964`*^9, 3.7893352399244757`*^9, {
   3.7893389039050145`*^9, 3.7893389225963078`*^9}, {3.7893389670934963`*^9, 
   3.7893389890931015`*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"d0c44048-e433-4ae0-922f-2cfd53adc7f4"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "a4"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7893231613557005`*^9, 3.7893234397511044`*^9, 3.7893304169021177`*^9, 
   3.7893304533149104`*^9, 3.7893352066623964`*^9, 3.7893352399244757`*^9, {
   3.7893389039050145`*^9, 3.7893389225963078`*^9}, {3.7893389670934963`*^9, 
   3.7893389891229844`*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"358664ab-f860-4c73-915e-08910a0d3de9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "}"}], " ", "**", " ", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.7893233158901777`*^9, 3.7893233619045925`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"82719584-92b9-462c-a435-d0492740fa43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "}"}], "**", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}]], "Output",
 CellChangeTimes->{{3.789323356962678*^9, 3.789323363546872*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"c0b43532-e458-4235-b7c9-2f6e90881f84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", "b1"}], "-", 
           RowBox[{"a2", " ", "b2"}], "-", 
           RowBox[{"a3", " ", "b3"}], "-", 
           RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "x01"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a2", " ", "b1"}], "+", 
           RowBox[{"a1", " ", "b2"}], "-", 
           RowBox[{"a4", " ", "b3"}], "+", 
           RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "x02"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a3", " ", "b1"}], "+", 
           RowBox[{"a4", " ", "b2"}], "+", 
           RowBox[{"a1", " ", "b3"}], "-", 
           RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "x03"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a4", " ", "b1"}], "-", 
           RowBox[{"a3", " ", "b2"}], "+", 
           RowBox[{"a2", " ", "b3"}], "+", 
           RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "x04"}]}], "\[Equal]", 
       " ", "c1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a2", " ", "b1"}], "+", 
           RowBox[{"a1", " ", "b2"}], "-", 
           RowBox[{"a4", " ", "b3"}], "+", 
           RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "x01"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", "b1"}], "-", 
           RowBox[{"a2", " ", "b2"}], "-", 
           RowBox[{"a3", " ", "b3"}], "-", 
           RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "x02"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a4", " ", "b1"}], "-", 
           RowBox[{"a3", " ", "b2"}], "+", 
           RowBox[{"a2", " ", "b3"}], "+", 
           RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "x03"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a3", " ", "b1"}], "+", 
           RowBox[{"a4", " ", "b2"}], "+", 
           RowBox[{"a1", " ", "b3"}], "-", 
           RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "x04"}]}], " ", 
       "\[Equal]", " ", "c2"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a3", " ", "b1"}], "+", 
           RowBox[{"a4", " ", "b2"}], "+", 
           RowBox[{"a1", " ", "b3"}], "-", 
           RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "x01"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a4", " ", "b1"}], "-", 
           RowBox[{"a3", " ", "b2"}], "+", 
           RowBox[{"a2", " ", "b3"}], "+", 
           RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "x02"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", "b1"}], "-", 
           RowBox[{"a2", " ", "b2"}], "-", 
           RowBox[{"a3", " ", "b3"}], "-", 
           RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "x03"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a2", " ", "b1"}], "+", 
           RowBox[{"a1", " ", "b2"}], "-", 
           RowBox[{"a4", " ", "b3"}], "+", 
           RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "x04"}]}], " ", 
       "\[Equal]", " ", "c3"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a4", " ", "b1"}], "-", 
           RowBox[{"a3", " ", "b2"}], "+", 
           RowBox[{"a2", " ", "b3"}], "+", 
           RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "x01"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a3", " ", "b1"}], "+", 
           RowBox[{"a4", " ", "b2"}], "+", 
           RowBox[{"a1", " ", "b3"}], "-", 
           RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "x02"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a2", " ", "b1"}], "+", 
           RowBox[{"a1", " ", "b2"}], "-", 
           RowBox[{"a4", " ", "b3"}], "+", 
           RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "x03"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a1", " ", "b1"}], "-", 
           RowBox[{"a2", " ", "b2"}], "-", 
           RowBox[{"a3", " ", "b3"}], "-", 
           RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "x04"}]}], " ", 
       "\[Equal]", " ", "c4"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], " ", "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.78932345538536*^9, 3.7893234600670376`*^9}, {
  3.7893236994353704`*^9, 3.789323756786297*^9}, {3.789323787595009*^9, 
  3.7893238091894293`*^9}, {3.789323956841753*^9, 3.7893239705115833`*^9}, {
  3.7893240023144255`*^9, 3.7893240345414715`*^9}, {3.7893242079824114`*^9, 
  3.7893242262218027`*^9}, {3.789324676593581*^9, 3.7893247383375673`*^9}, {
  3.7893302230762067`*^9, 3.789330230424282*^9}, {3.7893352578203497`*^9, 
  3.7893353450009775`*^9}, {3.7893354860883904`*^9, 3.789335490347908*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2fd3bb2e-3861-401d-8cdd-d54ab9609126"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x01", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a3"}], " ", "b3", " ", "c1"}], "-", 
        RowBox[{"a4", " ", "b4", " ", "c1"}], "-", 
        RowBox[{"a4", " ", "b3", " ", "c2"}], "+", 
        RowBox[{"a3", " ", "b4", " ", "c2"}], "+", 
        RowBox[{"a3", " ", "b1", " ", "c3"}], "+", 
        RowBox[{"a4", " ", "b2", " ", "c3"}], "+", 
        RowBox[{"a4", " ", "b1", " ", "c4"}], "-", 
        RowBox[{"a3", " ", "b2", " ", "c4"}], "+", 
        RowBox[{"a2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b2"}], " ", "c1"}], "+", 
           RowBox[{"b1", " ", "c2"}], "-", 
           RowBox[{"b4", " ", "c3"}], "+", 
           RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
        RowBox[{"a1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b1", " ", "c1"}], "+", 
           RowBox[{"b2", " ", "c2"}], "+", 
           RowBox[{"b3", " ", "c3"}], "+", 
           RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a1", "2"], "+", 
          SuperscriptBox["a2", "2"], "+", 
          SuperscriptBox["a3", "2"], "+", 
          SuperscriptBox["a4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b1", "2"], "+", 
          SuperscriptBox["b2", "2"], "+", 
          SuperscriptBox["b3", "2"], "+", 
          SuperscriptBox["b4", "2"]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"x02", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a4", " ", "b3", " ", "c1"}], "-", 
        RowBox[{"a3", " ", "b4", " ", "c1"}], "-", 
        RowBox[{"a3", " ", "b3", " ", "c2"}], "-", 
        RowBox[{"a4", " ", "b4", " ", "c2"}], "-", 
        RowBox[{"a4", " ", "b1", " ", "c3"}], "+", 
        RowBox[{"a3", " ", "b2", " ", "c3"}], "+", 
        RowBox[{"a3", " ", "b1", " ", "c4"}], "+", 
        RowBox[{"a4", " ", "b2", " ", "c4"}], "+", 
        RowBox[{"a1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b2"}], " ", "c1"}], "+", 
           RowBox[{"b1", " ", "c2"}], "-", 
           RowBox[{"b4", " ", "c3"}], "+", 
           RowBox[{"b3", " ", "c4"}]}], ")"}]}], "-", 
        RowBox[{"a2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b1", " ", "c1"}], "+", 
           RowBox[{"b2", " ", "c2"}], "+", 
           RowBox[{"b3", " ", "c3"}], "+", 
           RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a1", "2"], "+", 
          SuperscriptBox["a2", "2"], "+", 
          SuperscriptBox["a3", "2"], "+", 
          SuperscriptBox["a4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b1", "2"], "+", 
          SuperscriptBox["b2", "2"], "+", 
          SuperscriptBox["b3", "2"], "+", 
          SuperscriptBox["b4", "2"]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"x03", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a1"}], " ", "b3", " ", "c1"}], "+", 
        RowBox[{"a2", " ", "b4", " ", "c1"}], "+", 
        RowBox[{"a2", " ", "b3", " ", "c2"}], "+", 
        RowBox[{"a1", " ", "b4", " ", "c2"}], "+", 
        RowBox[{"a1", " ", "b1", " ", "c3"}], "-", 
        RowBox[{"a2", " ", "b2", " ", "c3"}], "-", 
        RowBox[{"a2", " ", "b1", " ", "c4"}], "-", 
        RowBox[{"a1", " ", "b2", " ", "c4"}], "+", 
        RowBox[{"a4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b2"}], " ", "c1"}], "+", 
           RowBox[{"b1", " ", "c2"}], "-", 
           RowBox[{"b4", " ", "c3"}], "+", 
           RowBox[{"b3", " ", "c4"}]}], ")"}]}], "-", 
        RowBox[{"a3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b1", " ", "c1"}], "+", 
           RowBox[{"b2", " ", "c2"}], "+", 
           RowBox[{"b3", " ", "c3"}], "+", 
           RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a1", "2"], "+", 
          SuperscriptBox["a2", "2"], "+", 
          SuperscriptBox["a3", "2"], "+", 
          SuperscriptBox["a4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b1", "2"], "+", 
          SuperscriptBox["b2", "2"], "+", 
          SuperscriptBox["b3", "2"], "+", 
          SuperscriptBox["b4", "2"]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"x04", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a2"}], " ", "b3", " ", "c1"}], "-", 
        RowBox[{"a1", " ", "b4", " ", "c1"}], "-", 
        RowBox[{"a1", " ", "b3", " ", "c2"}], "+", 
        RowBox[{"a2", " ", "b4", " ", "c2"}], "+", 
        RowBox[{"a2", " ", "b1", " ", "c3"}], "+", 
        RowBox[{"a1", " ", "b2", " ", "c3"}], "+", 
        RowBox[{"a1", " ", "b1", " ", "c4"}], "-", 
        RowBox[{"a2", " ", "b2", " ", "c4"}], "+", 
        RowBox[{"a3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b2", " ", "c1"}], "-", 
           RowBox[{"b1", " ", "c2"}], "+", 
           RowBox[{"b4", " ", "c3"}], "-", 
           RowBox[{"b3", " ", "c4"}]}], ")"}]}], "-", 
        RowBox[{"a4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b1", " ", "c1"}], "+", 
           RowBox[{"b2", " ", "c2"}], "+", 
           RowBox[{"b3", " ", "c3"}], "+", 
           RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a1", "2"], "+", 
          SuperscriptBox["a2", "2"], "+", 
          SuperscriptBox["a3", "2"], "+", 
          SuperscriptBox["a4", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b1", "2"], "+", 
          SuperscriptBox["b2", "2"], "+", 
          SuperscriptBox["b3", "2"], "+", 
          SuperscriptBox["b4", "2"]}], ")"}]}], ")"}]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.789330376247225*^9, 3.789335306895078*^9, 
  3.789335353329731*^9, 3.7893355027915163`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"c0ba79d5-aefb-4950-b186-f82ba983850c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"c1", "\[Rule]", 
     RowBox[{"a1b1x01", "-", 
      RowBox[{"a2", "b2", "x01"}], "-", 
      RowBox[{"a3", "b3", "x01"}], "-", 
      RowBox[{"a4", "b4", "x01"}], "-", 
      RowBox[{"a2", "b1", "x02"}], "-", 
      RowBox[{"a1", "b2", "x02"}], "+", 
      RowBox[{"a4", "b3", "x02"}], "-", 
      RowBox[{"a3", "b4", "x02"}], "-", 
      RowBox[{"a3", "b1", "x03"}], "-", 
      RowBox[{"a4", "b2", "x03"}], "-", 
      RowBox[{"a1", "b3", "x03"}], "+", 
      RowBox[{"a2", "b4", "x03"}], "-", 
      RowBox[{"a4", "b1", "x04"}], "+", 
      RowBox[{"a3", "b2", "x04"}], "-", 
      RowBox[{"a2", "b3", "x04"}], "-", 
      RowBox[{"a1", "b4", "x04"}]}]}], ",", 
    RowBox[{"c2", "\[Rule]", 
     RowBox[{
      RowBox[{"a2", "b1", "x01"}], "+", 
      RowBox[{"a1", "b2", "x01"}], "-", 
      RowBox[{"a4", "b3", "x01"}], "+", 
      RowBox[{"a3", "b4", "x01"}], "+", 
      RowBox[{"a1", "b1", "x02"}], "-", 
      RowBox[{"a2", "b2", "x02"}], "-", 
      RowBox[{"a3", "b3", "x02"}], "-", 
      RowBox[{"a4", "b4", "x02"}], "+", 
      RowBox[{"a4", "b1", "x03"}], "-", 
      RowBox[{"a3", "b2", "x03"}], "+", 
      RowBox[{"a2", "b3", "x03"}], "+", 
      RowBox[{"a1", "b4", "x03"}], "-", 
      RowBox[{"a3", "b1", "x04"}], "-", 
      RowBox[{"a4", "b2", "x04"}], "-", 
      RowBox[{"a1", "b3", "x04"}], "+", 
      RowBox[{"a2", "b4", "x04"}]}]}], ",", 
    RowBox[{"c3", "\[Rule]", 
     RowBox[{
      RowBox[{"a3", "b1", "x01"}], "+", 
      RowBox[{"a4", "b2", "x01"}], "+", 
      RowBox[{"a1", "b3", "x01"}], "-", 
      RowBox[{"a2", "b4", "x01"}], "-", 
      RowBox[{"a4", "b1", "x02"}], "+", 
      RowBox[{"a3", "b2", "x02"}], "-", 
      RowBox[{"a2", "b3", "x02"}], "-", 
      RowBox[{"a1", "b4", "x02"}], "+", 
      RowBox[{"a1", "b1", "x03"}], "-", 
      RowBox[{"a2", "b2", "x03"}], "-", 
      RowBox[{"a3", "b3", "x03"}], "-", 
      RowBox[{"a4", "b4", "x03"}], "+", 
      RowBox[{"a2", "b1", "x04"}], "+", 
      RowBox[{"a1", "b2", "x04"}], "-", 
      RowBox[{"a4", "b3", "x04"}], "+", 
      RowBox[{"a3", "b4", "x04"}]}]}], ",", 
    RowBox[{"c4", "\[Rule]", 
     RowBox[{
      RowBox[{"a4", "b1", "x01"}], "-", 
      RowBox[{"a3", "b2", "x01"}], "+", 
      RowBox[{"a2", "b3", "x01"}], "+", 
      RowBox[{"a1", "b4", "x01"}], "+", 
      RowBox[{"a3", "b1", "x02"}], "+", 
      RowBox[{"a4", "b2", "x02"}], "+", 
      RowBox[{"a1", "b3", "x02"}], "-", 
      RowBox[{"a2", "b4", "x02"}], "-", 
      RowBox[{"a2", "b1", "x03"}], "-", 
      RowBox[{"a1", "b2", "x03"}], "+", 
      RowBox[{"a4", "b3", "x03"}], "-", 
      RowBox[{"a3", "b4", "x03"}], "+", 
      RowBox[{"a1", "b1", "x04"}], "-", 
      RowBox[{"a2", "b2", "x04"}], "-", 
      RowBox[{"a3", "b3", "x04"}], "-", 
      RowBox[{"a4", "b4", "x04"}]}]}]}], "}"}], "}"}]], "Input",
 CellChangeTimes->{{3.789330352012294*^9, 
  3.7893303656266317`*^9}},ExpressionUUID->"962a30ad-65ba-4a40-b685-\
a1dc71b78bd0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"X0", "**", "Wa"}]], "Input",
 CellChangeTimes->{{3.789754334809249*^9, 3.7897543375808415`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"67a6808f-3d43-498a-b694-83b4b35971f0"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a1", " ", "x01"}], "-", 
    RowBox[{"a2", " ", "x02"}], "-", 
    RowBox[{"a3", " ", "x03"}], "-", 
    RowBox[{"a4", " ", "x04"}]}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "x01"}], "+", 
    RowBox[{"a1", " ", "x02"}], "+", 
    RowBox[{"a4", " ", "x03"}], "-", 
    RowBox[{"a3", " ", "x04"}]}], ",", 
   RowBox[{
    RowBox[{"a3", " ", "x01"}], "-", 
    RowBox[{"a4", " ", "x02"}], "+", 
    RowBox[{"a1", " ", "x03"}], "+", 
    RowBox[{"a2", " ", "x04"}]}], ",", 
   RowBox[{
    RowBox[{"a4", " ", "x01"}], "+", 
    RowBox[{"a3", " ", "x02"}], "-", 
    RowBox[{"a2", " ", "x03"}], "+", 
    RowBox[{"a1", " ", "x04"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.7897543385911417`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"917d04da-0e35-4ca9-ae02-89d7be66fe73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"a1", " ", "x01"}], "-", 
       RowBox[{"a2", " ", "x02"}], "-", 
       RowBox[{"a3", " ", "x03"}], "-", 
       RowBox[{"a4", " ", "x04"}]}], " ", "\[Equal]", " ", "1"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"a2", " ", "x01"}], "+", 
       RowBox[{"a1", " ", "x02"}], "+", 
       RowBox[{"a4", " ", "x03"}], "-", 
       RowBox[{"a3", " ", "x04"}]}], "\[Equal]", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"a3", " ", "x01"}], "-", 
       RowBox[{"a4", " ", "x02"}], "+", 
       RowBox[{"a1", " ", "x03"}], "+", 
       RowBox[{"a2", " ", "x04"}]}], " ", "\[Equal]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a4", " ", "x01"}], "+", 
       RowBox[{"a3", " ", "x02"}], "-", 
       RowBox[{"a2", " ", "x03"}], "+", 
       RowBox[{"a1", " ", "x04"}]}], "\[Equal]", " ", "0"}]}], " ", "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"x01", ",", "x02", ",", "x03", ",", "x04"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.789754341390661*^9, 3.789754400954791*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6caba930-2f4e-44c4-ac8d-5a24ad384333"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x01", "\[Rule]", 
     FractionBox["a1", 
      RowBox[{
       SuperscriptBox["a1", "2"], "+", 
       SuperscriptBox["a2", "2"], "+", 
       SuperscriptBox["a3", "2"], "+", 
       SuperscriptBox["a4", "2"]}]]}], ",", 
    RowBox[{"x02", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["a2", 
       RowBox[{
        SuperscriptBox["a1", "2"], "+", 
        SuperscriptBox["a2", "2"], "+", 
        SuperscriptBox["a3", "2"], "+", 
        SuperscriptBox["a4", "2"]}]]}]}], ",", 
    RowBox[{"x03", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["a3", 
       RowBox[{
        SuperscriptBox["a1", "2"], "+", 
        SuperscriptBox["a2", "2"], "+", 
        SuperscriptBox["a3", "2"], "+", 
        SuperscriptBox["a4", "2"]}]]}]}], ",", 
    RowBox[{"x04", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["a4", 
       RowBox[{
        SuperscriptBox["a1", "2"], "+", 
        SuperscriptBox["a2", "2"], "+", 
        SuperscriptBox["a3", "2"], "+", 
        SuperscriptBox["a4", "2"]}]]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7897544030215197`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"e52e4cdb-a149-4103-b4f2-79039b869980"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"NRefImu", "**", "NArmImu"}], ")"}], "**", "Wc", " "}]}]], "Input",
 CellChangeTimes->{{3.790923828002104*^9, 3.7909238447423925`*^9}, {
  3.7909240538755035`*^9, 3.790924078988719*^9}, {3.7909244146015925`*^9, 
  3.7909244147733965`*^9}, {3.7909244609250574`*^9, 3.7909244624980326`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"74f5f417-c743-43df-8391-9dc8cf1b0ec2"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", "b1"}], "-", 
       RowBox[{"a2", " ", "b2"}], "-", 
       RowBox[{"a3", " ", "b3"}], "-", 
       RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "c1"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a2", " ", "b1"}], "+", 
       RowBox[{"a1", " ", "b2"}], "-", 
       RowBox[{"a4", " ", "b3"}], "+", 
       RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "c2"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a3", " ", "b1"}], "+", 
       RowBox[{"a4", " ", "b2"}], "+", 
       RowBox[{"a1", " ", "b3"}], "-", 
       RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "c3"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a4", " ", "b1"}], "-", 
       RowBox[{"a3", " ", "b2"}], "+", 
       RowBox[{"a2", " ", "b3"}], "+", 
       RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "c4"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a2", " ", "b1"}], "+", 
       RowBox[{"a1", " ", "b2"}], "-", 
       RowBox[{"a4", " ", "b3"}], "+", 
       RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "c1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", "b1"}], "-", 
       RowBox[{"a2", " ", "b2"}], "-", 
       RowBox[{"a3", " ", "b3"}], "-", 
       RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "c2"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a4", " ", "b1"}], "-", 
       RowBox[{"a3", " ", "b2"}], "+", 
       RowBox[{"a2", " ", "b3"}], "+", 
       RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "c3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a3", " ", "b1"}], "+", 
       RowBox[{"a4", " ", "b2"}], "+", 
       RowBox[{"a1", " ", "b3"}], "-", 
       RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "c4"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a3", " ", "b1"}], "+", 
       RowBox[{"a4", " ", "b2"}], "+", 
       RowBox[{"a1", " ", "b3"}], "-", 
       RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "c1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a4", " ", "b1"}], "-", 
       RowBox[{"a3", " ", "b2"}], "+", 
       RowBox[{"a2", " ", "b3"}], "+", 
       RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "c2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", "b1"}], "-", 
       RowBox[{"a2", " ", "b2"}], "-", 
       RowBox[{"a3", " ", "b3"}], "-", 
       RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "c3"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a2", " ", "b1"}], "+", 
       RowBox[{"a1", " ", "b2"}], "-", 
       RowBox[{"a4", " ", "b3"}], "+", 
       RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "c4"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a4", " ", "b1"}], "-", 
       RowBox[{"a3", " ", "b2"}], "+", 
       RowBox[{"a2", " ", "b3"}], "+", 
       RowBox[{"a1", " ", "b4"}]}], ")"}], " ", "c1"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a3", " ", "b1"}], "+", 
       RowBox[{"a4", " ", "b2"}], "+", 
       RowBox[{"a1", " ", "b3"}], "-", 
       RowBox[{"a2", " ", "b4"}]}], ")"}], " ", "c2"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a2", " ", "b1"}], "+", 
       RowBox[{"a1", " ", "b2"}], "-", 
       RowBox[{"a4", " ", "b3"}], "+", 
       RowBox[{"a3", " ", "b4"}]}], ")"}], " ", "c3"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", " ", "b1"}], "-", 
       RowBox[{"a2", " ", "b2"}], "-", 
       RowBox[{"a3", " ", "b3"}], "-", 
       RowBox[{"a4", " ", "b4"}]}], ")"}], " ", "c4"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.790923914273718*^9, {3.7909240592580214`*^9, 3.790924080699733*^9}, 
   3.790924423330843*^9, 3.790924463493871*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"d29ccc1b-1de8-4fbb-8f8f-5a3022821f1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q0", "=", 
  RowBox[{"NRefImu", "**", 
   RowBox[{"(", 
    RowBox[{"NArmImu", "**", "Wc"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7909239630105705`*^9, 3.790923963577813*^9}, {
  3.790924045620281*^9, 3.7909240503431377`*^9}, {3.7909240860457807`*^9, 
  3.7909240894088087`*^9}, {3.790924418936252*^9, 3.7909244196093845`*^9}, {
  3.790924457044752*^9, 3.790924458722745*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"6fabd845-41d5-4064-819f-dfdf85f75b16"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "a4"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"a1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b4", " ", "c1"}], "-", 
       RowBox[{"b3", " ", "c2"}], "+", 
       RowBox[{"b2", " ", "c3"}], "+", 
       RowBox[{"b1", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b3", " ", "c1"}], "+", 
       RowBox[{"b4", " ", "c2"}], "+", 
       RowBox[{"b1", " ", "c3"}], "-", 
       RowBox[{"b2", " ", "c4"}]}], ")"}]}], "-", 
    RowBox[{"a3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b2", " ", "c1"}], "+", 
       RowBox[{"b1", " ", "c2"}], "-", 
       RowBox[{"b4", " ", "c3"}], "+", 
       RowBox[{"b3", " ", "c4"}]}], ")"}]}], "+", 
    RowBox[{"a4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b1", " ", "c1"}], "-", 
       RowBox[{"b2", " ", "c2"}], "-", 
       RowBox[{"b3", " ", "c3"}], "-", 
       RowBox[{"b4", " ", "c4"}]}], ")"}]}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.790923967045292*^9, {3.790924063584119*^9, 3.79092409009292*^9}, 
   3.7909244210342903`*^9, 3.7909244657859135`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"a9b230f0-bb11-42ef-bb79-c7c8af5c8715"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NArmImu", "**", "NRefImu"}]], "Input",
 CellChangeTimes->{{3.790923972840663*^9, 3.790923976022957*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"51a5240e-7efa-49e1-a875-5e2cf57bed13"],

Cell[BoxData[
 RowBox[{"Quaternion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a1", " ", "b1"}], "-", 
    RowBox[{"a2", " ", "b2"}], "-", 
    RowBox[{"a3", " ", "b3"}], "-", 
    RowBox[{"a4", " ", "b4"}]}], ",", 
   RowBox[{
    RowBox[{"a2", " ", "b1"}], "+", 
    RowBox[{"a1", " ", "b2"}], "+", 
    RowBox[{"a4", " ", "b3"}], "-", 
    RowBox[{"a3", " ", "b4"}]}], ",", 
   RowBox[{
    RowBox[{"a3", " ", "b1"}], "-", 
    RowBox[{"a4", " ", "b2"}], "+", 
    RowBox[{"a1", " ", "b3"}], "+", 
    RowBox[{"a2", " ", "b4"}]}], ",", 
   RowBox[{
    RowBox[{"a4", " ", "b1"}], "+", 
    RowBox[{"a3", " ", "b2"}], "-", 
    RowBox[{"a2", " ", "b3"}], "+", 
    RowBox[{"a1", " ", "b4"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.790923976914341*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"661e6abe-d862-4d9f-8131-617841dd83ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q0", "[", 
    RowBox[{"[", "4", "]"}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{"q", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], "//", " ", "Simplify"}]], "Input",
 CellChangeTimes->{{3.790924426633819*^9, 3.790924539495302*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"d9c52f27-1a4e-4e98-8cb2-b2d0558f0adf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7909244309378767`*^9, 3.7909245397522464`*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"cb5fe034-cfbe-4aab-8285-c8d0d59f28c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"source", " ", "=", " ", 
  "\"\<C:\\\\Users\\\\User\\\\Google \:0414\:0438\:0441\:043a\\\\\:0410\:0441\
\:043f\:0438\:0440\:0430\:043d\:0442\:0443\:0440\:0430\\\\\:0422\:0435\:0441\
\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435_IMU_android\\\\New_\
data_test_lecxis\\\\\:0412\:0438\:0434\:0435\:043e \:0438 \:0434\:0430\:0442\
\:0447\:0438\:043a\:0438\\\\\:0423\:0434\:0430\:0447\:043d\:044b\:0439 \:044d\
\:043a\:0441\:043f\:0435\:0440\:0438\:043c\:0435\:043d\:0442 \
1\\\\5559_14_02_2020_14_23_30.csv\>\""}], "\[IndentingNewLine]", 
 RowBox[{"Q", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"source", ",", " ", "\"\<CSV\>\""}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.791001283485797*^9, 3.7910013363659463`*^9}, {
  3.791001387543503*^9, 3.791001391228964*^9}, {3.791001473757681*^9, 
  3.791001495603174*^9}, {3.7910021479313903`*^9, 3.791002150461666*^9}, {
  3.7910025197443247`*^9, 3.7910025198879037`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"236a6854-a855-4cb1-8819-40c44dc0c6ca"],

Cell[BoxData["\<\"C:\\\\Users\\\\User\\\\Google \:0414\:0438\:0441\:043a\\\\\
\:0410\:0441\:043f\:0438\:0440\:0430\:043d\:0442\:0443\:0440\:0430\\\\\:0422\
\:0435\:0441\:0442\:0438\:0440\:043e\:0432\:0430\:043d\:0438\:0435_IMU_\
android\\\\New_data_test_lecxis\\\\\:0412\:0438\:0434\:0435\:043e \:0438 \
\:0434\:0430\:0442\:0447\:0438\:043a\:0438\\\\\:0423\:0434\:0430\:0447\:043d\
\:044b\:0439 \:044d\:043a\:0441\:043f\:0435\:0440\:0438\:043c\:0435\:043d\
\:0442 1\\\\5559_14_02_2020_14_23_30.csv\"\>"], "Output",
 CellChangeTimes->{{3.7910014504001923`*^9, 3.7910014965966215`*^9}, 
   3.791002155829379*^9, 3.7910025277733603`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"c782015f-8cbe-4a75-a8a5-c49cf2313ebf"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            
            RowBox[{"\<\"2020-02-12 22:40:46.965429\"\>", ",", "0.`", ",", 
             "0.`", ",", "0.`", ",", "0.`", ",", "0", ",", "0", ",", "0", ",",
              "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "0.9`"}], ",", 
             RowBox[{"-", "0.9`"}], ",", 
             RowBox[{"-", "0.48`"}], ",", "0.`", ",", 
             RowBox[{"-", "0.18`"}], ",", "0.01`", ",", "0.11279`", ",", 
             "0.1842`", ",", 
             RowBox[{"-", "0.70062`"}], ",", 
             RowBox[{"-", "0.68005`"}], ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            
            RowBox[{"\<\"2020-02-12 22:40:46.973416\"\>", ",", "9.88281`", 
             ",", "0.`", ",", "0.`", ",", "0.`", ",", "0", ",", "0", ",", "0",
              ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "0.9`"}], ",", 
             RowBox[{"-", "0.9`"}], ",", 
             RowBox[{"-", "0.48`"}], ",", "0.03`", ",", 
             RowBox[{"-", "0.23`"}], ",", "0.02`", ",", "0.11285`", ",", 
             "0.18427`", ",", 
             RowBox[{"-", "0.70062`"}], ",", 
             RowBox[{"-", "0.68005`"}], ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
           ",", 
           TemplateBox[{"4885"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            
            RowBox[{"\<\"2020-02-12 22:42:26.909161\"\>", ",", "99868.27343`",
              ",", "0.`", ",", "0.`", ",", "0.`", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "0.82`"}], ",", 
             RowBox[{"-", "0.82`"}], ",", 
             RowBox[{"-", "1.11`"}], ",", 
             RowBox[{"-", "0.37`"}], ",", 
             RowBox[{"-", "0.23`"}], ",", "0.05`", ",", "0.48877`", ",", 
             "0.58899`", ",", 
             RowBox[{"-", "0.45825`"}], ",", 
             RowBox[{"-", "0.45184`"}], ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
           "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{65., {3., 9.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 72, 18443306366819198457, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 72, 18443306366819198457, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 72, 18443306366819198457, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[18443306366819198457 === $SessionID, 
   Out[72], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.7910014504001923`*^9, 3.7910014965966215`*^9}, 
   3.791002155829379*^9, 3.7910025298758335`*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"0a9c79a0-be2b-42c1-bd10-97d0ab15d7e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "2"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", "Q", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", "L", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", "L", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Min", "[", "L", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.791001500966694*^9, 3.7910015472259274`*^9}, {
   3.79100158913815*^9, 3.7910016561436586`*^9}, {3.791001709473711*^9, 
   3.7910017118142414`*^9}, {3.7910017595606174`*^9, 3.791001792897668*^9}, {
   3.79100182528279*^9, 3.791001866945749*^9}, 3.7910019438304033`*^9, {
   3.791001976822442*^9, 3.791002016891061*^9}, {3.7910022304103527`*^9, 
   3.791002231070607*^9}, {3.79100226879776*^9, 3.791002274824554*^9}, {
   3.7910025408078713`*^9, 3.791002594519562*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"3c271255-b25f-4df0-9fa8-ac66ca5aca48"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.49699999999999994`], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.49699999999999994`], Thickness[Small]}], 
     RectangleBox[{4., 0}, {6., 124.},
      RoundingRadius->0], RectangleBox[{6., 0}, {8., 236.},
      RoundingRadius->0], RectangleBox[{8., 0}, {10., 1242.},
      RoundingRadius->0], RectangleBox[{10., 0}, {12., 1786.},
      RoundingRadius->0], RectangleBox[{12., 0}, {14., 273.},
      RoundingRadius->0], RectangleBox[{14., 0}, {16., 78.},
      RoundingRadius->0], RectangleBox[{16., 0}, {18., 19.},
      RoundingRadius->0], RectangleBox[{18., 0}, {20., 56.},
      RoundingRadius->0], RectangleBox[{20., 0}, {22., 112.},
      RoundingRadius->0], RectangleBox[{22., 0}, {24., 33.},
      RoundingRadius->0], RectangleBox[{24., 0}, {26., 22.},
      RoundingRadius->0], RectangleBox[{26., 0}, {28., 36.},
      RoundingRadius->0], RectangleBox[{28., 0}, {30., 75.},
      RoundingRadius->0], RectangleBox[{30., 0}, {32., 45.},
      RoundingRadius->0], RectangleBox[{32., 0}, {34., 21.},
      RoundingRadius->0], RectangleBox[{34., 0}, {36., 8.},
      RoundingRadius->0], RectangleBox[{36., 0}, {38., 7.},
      RoundingRadius->0], RectangleBox[{38., 0}, {40., 69.},
      RoundingRadius->0], RectangleBox[{40., 0}, {42., 57.},
      RoundingRadius->0], RectangleBox[{42., 0}, {44., 8.},
      RoundingRadius->0], RectangleBox[{44., 0}, {46., 11.},
      RoundingRadius->0], RectangleBox[{46., 0}, {48., 4.},
      RoundingRadius->0], RectangleBox[{48., 0}, {50., 16.},
      RoundingRadius->0], RectangleBox[{50., 0}, {52., 43.},
      RoundingRadius->0], RectangleBox[{54., 0}, {56., 2.},
      RoundingRadius->0], RectangleBox[{56., 0}, {58., 9.},
      RoundingRadius->0], RectangleBox[{58., 0}, {60., 43.},
      RoundingRadius->0], RectangleBox[{60., 0}, {62., 93.},
      RoundingRadius->0], RectangleBox[{62., 0}, {64., 8.},
      RoundingRadius->0], RectangleBox[{64., 0}, {66., 3.},
      RoundingRadius->0], RectangleBox[{66., 0}, {68., 4.},
      RoundingRadius->0], RectangleBox[{68., 0}, {70., 15.},
      RoundingRadius->0], RectangleBox[{70., 0}, {72., 28.},
      RoundingRadius->0], RectangleBox[{72., 0}, {74., 4.},
      RoundingRadius->0], RectangleBox[{74., 0}, {76., 6.},
      RoundingRadius->0], RectangleBox[{76., 0}, {78., 14.},
      RoundingRadius->0], RectangleBox[{78., 0}, {80., 28.},
      RoundingRadius->0], RectangleBox[{80., 0}, {82., 31.},
      RoundingRadius->0], RectangleBox[{82., 0}, {84., 3.},
      RoundingRadius->0], RectangleBox[{84., 0}, {86., 6.},
      RoundingRadius->0], RectangleBox[{86., 0}, {88., 3.},
      RoundingRadius->0], RectangleBox[{88., 0}, {90., 16.},
      RoundingRadius->0], RectangleBox[{90., 0}, {92., 33.},
      RoundingRadius->0], RectangleBox[{92., 0}, {94., 2.},
      RoundingRadius->0], RectangleBox[{96., 0}, {98., 3.},
      RoundingRadius->0], RectangleBox[{98., 0}, {100., 14.},
      RoundingRadius->0], RectangleBox[{100., 0}, {102., 38.},
      RoundingRadius->0], RectangleBox[{104., 0}, {106., 1.},
      RoundingRadius->0], RectangleBox[{106., 0}, {108., 2.},
      RoundingRadius->0], RectangleBox[{108., 0}, {110., 14.},
      RoundingRadius->0], RectangleBox[{110., 0}, {112., 25.},
      RoundingRadius->0], RectangleBox[{112., 0}, {114., 4.},
      RoundingRadius->0], RectangleBox[{116., 0}, {118., 2.},
      RoundingRadius->0], RectangleBox[{118., 0}, {120., 7.},
      RoundingRadius->0], RectangleBox[{120., 0}, {122., 9.},
      RoundingRadius->0], RectangleBox[{122., 0}, {124., 4.},
      RoundingRadius->0], RectangleBox[{126., 0}, {128., 3.},
      RoundingRadius->0], RectangleBox[{128., 0}, {130., 6.},
      RoundingRadius->0], RectangleBox[{130., 0}, {132., 3.},
      RoundingRadius->0], RectangleBox[{132., 0}, {134., 4.},
      RoundingRadius->0], RectangleBox[{134., 0}, {136., 2.},
      RoundingRadius->0], RectangleBox[{136., 0}, {138., 1.},
      RoundingRadius->0], RectangleBox[{140., 0}, {142., 3.},
      RoundingRadius->0], RectangleBox[{146., 0}, {148., 1.},
      RoundingRadius->0], RectangleBox[{148., 0}, {150., 3.},
      RoundingRadius->0], RectangleBox[{160., 0}, {162., 2.},
      RoundingRadius->0], RectangleBox[{162., 0}, {164., 1.},
      RoundingRadius->0], RectangleBox[{170., 0}, {172., 1.},
      RoundingRadius->0], RectangleBox[{178., 0}, {180., 1.},
      RoundingRadius->0], RectangleBox[{190., 0}, {192., 1.},
      RoundingRadius->
       0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{2.92, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{1064., Automatic},
  PlotRange->{{4, 58}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.791001504729931*^9, 3.791001547628868*^9}, {
   3.7910018209483557`*^9, 3.7910018801503305`*^9}, 3.7910019456971693`*^9, 
   3.7910020261273656`*^9, 3.791002170431859*^9, 3.79100224288455*^9, 
   3.791002276348302*^9, {3.7910025476991405`*^9, 3.791002595023181*^9}},
 CellLabel->"Out[78]=",ExpressionUUID->"6f7d0bae-2cdc-4ac8-9906-a44f19de90da"],

Cell[BoxData["190.10155999999995`"], "Output",
 CellChangeTimes->{{3.791001504729931*^9, 3.791001547628868*^9}, {
   3.7910018209483557`*^9, 3.7910018801503305`*^9}, 3.7910019456971693`*^9, 
   3.7910020261273656`*^9, 3.791002170431859*^9, 3.79100224288455*^9, 
   3.791002276348302*^9, {3.7910025476991405`*^9, 3.7910025950510693`*^9}},
 CellLabel->"Out[79]=",ExpressionUUID->"a267e9e3-2c60-4f93-a9f7-61077e8c139b"],

Cell[BoxData["4.4375`"], "Output",
 CellChangeTimes->{{3.791001504729931*^9, 3.791001547628868*^9}, {
   3.7910018209483557`*^9, 3.7910018801503305`*^9}, 3.7910019456971693`*^9, 
   3.7910020261273656`*^9, 3.791002170431859*^9, 3.79100224288455*^9, 
   3.791002276348302*^9, {3.7910025476991405`*^9, 3.7910025950910597`*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"fcf594fd-7ac4-4cef-9fa7-6819fc49dd85"]
}, Open  ]]
},
WindowSize->{1288, 988},
WindowMargins->{{Automatic, 3}, {Automatic, 4}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 134, 2, 28, "Input",ExpressionUUID->"1a423ba5-509c-4106-8a0e-d1be1ea25de7"],
Cell[695, 24, 1519, 43, 181, "Input",ExpressionUUID->"7a0613a9-044a-4a9d-ac34-ff9801eaa194"],
Cell[CellGroupData[{
Cell[2239, 71, 2070, 60, 181, "Input",ExpressionUUID->"a49f5a99-b1d8-4e04-8b1e-edb2ffdcb692"],
Cell[4312, 133, 222, 4, 32, "Output",ExpressionUUID->"15c77e51-74a3-47b7-9df9-0c32269419d5"],
Cell[4537, 139, 284, 5, 32, "Output",ExpressionUUID->"423be174-a67e-4afb-b9fb-e77d1f2cf03d"],
Cell[4824, 146, 286, 5, 32, "Output",ExpressionUUID->"10566cd7-96e4-4ee6-87ce-58144a42a20e"]
}, Open  ]],
Cell[5125, 154, 1764, 51, 162, "Input",ExpressionUUID->"0df3f08d-f360-4e1f-ab99-ed717673b09e"],
Cell[CellGroupData[{
Cell[6914, 209, 285, 5, 28, "Input",ExpressionUUID->"cc426fe5-14f3-494c-9932-c74cf05f518d"],
Cell[7202, 216, 253, 5, 32, "Output",ExpressionUUID->"a70f83fd-aa60-41ad-9c71-887949104d29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7492, 226, 695, 13, 48, "Input",ExpressionUUID->"19c130cc-1387-4d42-b7ea-e320baa10302"],
Cell[8190, 241, 463, 8, 32, "Output",ExpressionUUID->"d0c44048-e433-4ae0-922f-2cfd53adc7f4"],
Cell[8656, 251, 4187, 126, 90, "Output",ExpressionUUID->"358664ab-f860-4c73-915e-08910a0d3de9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12880, 382, 360, 7, 28, "Input",ExpressionUUID->"82719584-92b9-462c-a435-d0492740fa43"],
Cell[13243, 391, 342, 7, 32, "Output",ExpressionUUID->"c0b43532-e458-4235-b7c9-2f6e90881f84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13622, 403, 5361, 140, 158, "Input",ExpressionUUID->"2fd3bb2e-3861-401d-8cdd-d54ab9609126"],
Cell[18986, 545, 6475, 173, 194, "Output",ExpressionUUID->"c0ba79d5-aefb-4950-b186-f82ba983850c"]
}, Open  ]],
Cell[25476, 721, 2995, 77, 86, "Input",ExpressionUUID->"962a30ad-65ba-4a40-b685-a1dc71b78bd0"],
Cell[CellGroupData[{
Cell[28496, 802, 199, 3, 28, "Input",ExpressionUUID->"67a6808f-3d43-498a-b694-83b4b35971f0"],
Cell[28698, 807, 854, 24, 32, "Output",ExpressionUUID->"917d04da-0e35-4ca9-ae02-89d7be66fe73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29589, 836, 1240, 34, 66, "Input",ExpressionUUID->"6caba930-2f4e-44c4-ac8d-5a24ad384333"],
Cell[30832, 872, 1221, 36, 50, "Output",ExpressionUUID->"e52e4cdb-a149-4103-b4f2-79039b869980"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32090, 913, 442, 8, 28, "Input",ExpressionUUID->"74f5f417-c743-43df-8391-9dc8cf1b0ec2"],
Cell[32535, 923, 4007, 122, 90, "Output",ExpressionUUID->"d29ccc1b-1de8-4fbb-8f8f-5a3022821f1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36579, 1050, 485, 9, 28, "Input",ExpressionUUID->"6fabd845-41d5-4064-819f-dfdf85f75b16"],
Cell[37067, 1061, 4050, 124, 90, "Output",ExpressionUUID->"a9b230f0-bb11-42ef-bb79-c7c8af5c8715"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41154, 1190, 207, 3, 28, "Input",ExpressionUUID->"51a5240e-7efa-49e1-a875-5e2cf57bed13"],
Cell[41364, 1195, 836, 24, 32, "Output",ExpressionUUID->"661e6abe-d862-4d9f-8131-617841dd83ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42237, 1224, 356, 8, 45, "Input",ExpressionUUID->"d9c52f27-1a4e-4e98-8cb2-b2d0558f0adf"],
Cell[42596, 1234, 180, 2, 32, "Output",ExpressionUUID->"cb5fe034-cfbe-4aab-8285-c8d0d59f28c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42813, 1241, 1028, 16, 83, "Input",ExpressionUUID->"236a6854-a855-4cb1-8819-40c44dc0c6ca"],
Cell[43844, 1259, 713, 9, 32, "Output",ExpressionUUID->"c782015f-8cbe-4a75-a8a5-c49cf2313ebf"],
Cell[44560, 1270, 11013, 273, 150, "Output",ExpressionUUID->"0a9c79a0-be2b-42c1-bd10-97d0ab15d7e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55610, 1548, 1274, 29, 196, "Input",ExpressionUUID->"3c271255-b25f-4df0-9fa8-ac66ca5aca48"],
Cell[56887, 1579, 5810, 102, 662, "Output",ExpressionUUID->"6f7d0bae-2cdc-4ac8-9906-a44f19de90da"],
Cell[62700, 1683, 416, 5, 32, "Output",ExpressionUUID->"a267e9e3-2c60-4f93-a9f7-61077e8c139b"],
Cell[63119, 1690, 404, 5, 32, "Output",ExpressionUUID->"fcf594fd-7ac4-4cef-9fa7-6819fc49dd85"]
}, Open  ]]
}
]
*)

